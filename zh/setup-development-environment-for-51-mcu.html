<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建51单片机开发环境 | 学习嵌入式系统</title>
    <meta name="description" content="这里有一些关于嵌入式系统的文章.">
    <meta name="generator" content="VitePress v1.0.0-rc.44">
    <link rel="preload stylesheet" href="/learn-embedded-system/assets/style.CA-AjTBo.css" as="style">
    
    <script type="module" src="/learn-embedded-system/assets/app.z0bkpnR2.js"></script>
    <link rel="preload" href="/learn-embedded-system/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/learn-embedded-system/assets/chunks/framework.CAtmHNXG.js">
    <link rel="modulepreload" href="/learn-embedded-system/assets/chunks/theme.DKRenspX.js">
    <link rel="modulepreload" href="/learn-embedded-system/assets/zh_setup-development-environment-for-51-mcu.md.khDq-pYu.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-734217b9><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f78c1263></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-f78c1263> Skip to content </a><!--]--><!----><header class="VPNav" data-v-734217b9 data-v-3e0201d8><div class="VPNavBar" data-v-3e0201d8 data-v-6586a85a><div class="wrapper" data-v-6586a85a><div class="container" data-v-6586a85a><div class="title" data-v-6586a85a><div class="VPNavBarTitle" data-v-6586a85a data-v-29285982><a class="title" href="/learn-embedded-system/zh/" data-v-29285982><!--[--><!--]--><!--[--><img class="VPImage logo" src="/learn-embedded-system/big-yellow.svg" alt data-v-9cf6620a><!--]--><span data-v-29285982>学习嵌入式系统</span><!--[--><!--]--></a></div></div><div class="content" data-v-6586a85a><div class="content-body" data-v-6586a85a><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6586a85a><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6586a85a data-v-cf62cc71><span id="main-nav-aria-label" class="visually-hidden" data-v-cf62cc71>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/learn-embedded-system/" tabindex="0" data-v-cf62cc71 data-v-d4814e7a><!--[--><span data-v-d4814e7a>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://arnosolo.github.io/blog/" target="_blank" rel="noreferrer" tabindex="0" data-v-cf62cc71 data-v-d4814e7a><!--[--><span data-v-d4814e7a>About</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-6586a85a data-v-2ebf59e6 data-v-0b717c22><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-0b717c22><span class="text" data-v-0b717c22><span class="vpi-languages option-icon" data-v-0b717c22></span><!----><span class="vpi-chevron-down text-icon" data-v-0b717c22></span></span></button><div class="menu" data-v-0b717c22><div class="VPMenu" data-v-0b717c22 data-v-77498765><!----><!--[--><!--[--><div class="items" data-v-2ebf59e6><p class="title" data-v-2ebf59e6>简体中文</p><!--[--><div class="VPMenuLink" data-v-2ebf59e6 data-v-db5680d9><a class="VPLink link" href="/learn-embedded-system/setup-development-environment-for-51-mcu.html" data-v-db5680d9><!--[-->English<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-6586a85a data-v-6196c97b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-6196c97b data-v-79322c52 data-v-8e9c72b5><span class="check" data-v-8e9c72b5><span class="icon" data-v-8e9c72b5><!--[--><span class="vpi-sun sun" data-v-79322c52></span><span class="vpi-moon moon" data-v-79322c52></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6586a85a data-v-c06f95c4 data-v-37a714c5><!--[--><a class="VPSocialLink no-icon" href="https://github.com/arnosolo" aria-label="github" target="_blank" rel="noopener" data-v-37a714c5 data-v-036f7a16><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6586a85a data-v-f8fe37b2 data-v-0b717c22><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-0b717c22><span class="vpi-more-horizontal icon" data-v-0b717c22></span></button><div class="menu" data-v-0b717c22><div class="VPMenu" data-v-0b717c22 data-v-77498765><!----><!--[--><!--[--><div class="group translations" data-v-f8fe37b2><p class="trans-title" data-v-f8fe37b2>简体中文</p><!--[--><div class="VPMenuLink" data-v-f8fe37b2 data-v-db5680d9><a class="VPLink link" href="/learn-embedded-system/setup-development-environment-for-51-mcu.html" data-v-db5680d9><!--[-->English<!--]--></a></div><!--]--></div><div class="group" data-v-f8fe37b2><div class="item appearance" data-v-f8fe37b2><p class="label" data-v-f8fe37b2>Appearance</p><div class="appearance-action" data-v-f8fe37b2><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-f8fe37b2 data-v-79322c52 data-v-8e9c72b5><span class="check" data-v-8e9c72b5><span class="icon" data-v-8e9c72b5><!--[--><span class="vpi-sun sun" data-v-79322c52></span><span class="vpi-moon moon" data-v-79322c52></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f8fe37b2><div class="item social-links" data-v-f8fe37b2><div class="VPSocialLinks social-links-list" data-v-f8fe37b2 data-v-37a714c5><!--[--><a class="VPSocialLink no-icon" href="https://github.com/arnosolo" aria-label="github" target="_blank" rel="noopener" data-v-37a714c5 data-v-036f7a16><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6586a85a data-v-fb186f55><span class="container" data-v-fb186f55><span class="top" data-v-fb186f55></span><span class="middle" data-v-fb186f55></span><span class="bottom" data-v-fb186f55></span></span></button></div></div></div></div><div class="divider" data-v-6586a85a><div class="divider-line" data-v-6586a85a></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-734217b9 data-v-e01d0f74><div class="container" data-v-e01d0f74><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-e01d0f74 data-v-2688044d><button data-v-2688044d>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-734217b9 data-v-7a1aa57b><div class="VPDoc has-aside" data-v-7a1aa57b data-v-7208151a><!--[--><!--]--><div class="container" data-v-7208151a><div class="aside" data-v-7208151a><div class="aside-curtain" data-v-7208151a></div><div class="aside-container" data-v-7208151a><div class="aside-content" data-v-7208151a><div class="VPDocAside" data-v-7208151a data-v-842ce547><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-842ce547 data-v-663e5535><div class="content" data-v-663e5535><div class="outline-marker" data-v-663e5535></div><div class="outline-title" role="heading" aria-level="2" data-v-663e5535>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-663e5535><span class="visually-hidden" id="doc-outline-aria-label" data-v-663e5535> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-663e5535 data-v-837e4f9f><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-842ce547></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7208151a><div class="content-container" data-v-7208151a><!--[--><!--]--><main class="main" data-v-7208151a><div style="position:relative;" class="vp-doc _learn-embedded-system_zh_setup-development-environment-for-51-mcu" data-v-7208151a><div><h1 id="搭建51单片机开发环境" tabindex="-1">搭建51单片机开发环境 <a class="header-anchor" href="#搭建51单片机开发环境" aria-label="Permalink to &quot;搭建51单片机开发环境&quot;">​</a></h1><h2 id="效果展示" tabindex="-1">效果展示 <a class="header-anchor" href="#效果展示" aria-label="Permalink to &quot;效果展示&quot;">​</a></h2><p>点亮<code>D2</code>LED灯 <img src="/learn-embedded-system/assets/609301928e19be72f5574acb143a373156abe1784da065a7aadd7e8e06b7bd15.Bt-J-wLP.jpeg" alt="picture 0"></p><h2 id="前提条件" tabindex="-1">前提条件 <a class="header-anchor" href="#前提条件" aria-label="Permalink to &quot;前提条件&quot;">​</a></h2><ol><li>已学习<code>微机原理</code></li><li>了解如何在终端中运行<code>指令</code></li><li>一块<code>51单片机开发板</code>(本文采用了普中A2开发板, MCU为STC89C52RC)</li><li>下载<code>开发板原理图</code>. <a href="http://www.prechin.cn/gongsixinwen/208.html" target="_blank" rel="noreferrer">普中科技-各型号产品资料下载链接</a></li><li>下载<code>STC89C52RC数据手册</code>. <a href="https://www.stcmicro.com/cn/sjsc.html" target="_blank" rel="noreferrer">STC 技术支持 数据手册</a></li></ol><h2 id="原理解析" tabindex="-1">原理解析 <a class="header-anchor" href="#原理解析" aria-label="Permalink to &quot;原理解析&quot;">​</a></h2><ol><li>打开<code>开发板原理图</code>, 找到<code>D2</code>LED灯. 发现其一端连着<code>VCC</code>, 另一端连着<code>P2.1</code>引脚.</li><li>打开<code>STC89C52RC数据手册</code>, 找到管脚说明章节. 发现<code>P2.1</code>引脚内部有上拉电阻, 未使用时为高电平, 故<code>D2</code>LED灯默认不亮, 需要单片机将<code>P2.1</code>引脚设置为低电平才会亮. 这一步需要修改单片机中的程序才能实现.</li><li>修改单片机中的程序总共需要3步. <code>main.c</code> -编译-&gt; <code>firmware.hex</code> -烧录-&gt; <code>MCU ROM</code><ul><li>使用c语言编写一个文本文件<code>main.c</code></li><li>使用编译器将<code>main.c</code>文件转换为一个机器码文件<code>firmware.hex</code>(当然也可以叫其它名字)</li><li>使用烧录器将<code>firmware.hex</code>文件烧录到单片机ROM中</li></ul></li></ol><h2 id="实现" tabindex="-1">实现 <a class="header-anchor" href="#实现" aria-label="Permalink to &quot;实现&quot;">​</a></h2><h3 id="安装编译器-sdcc" tabindex="-1">安装编译器 SDCC <a class="header-anchor" href="#安装编译器-sdcc" aria-label="Permalink to &quot;安装编译器 SDCC&quot;">​</a></h3><p>本文使用的编译器是<a href="https://sdcc.sourceforge.net/" target="_blank" rel="noreferrer">SDCC</a>.</p><ul><li>Window: 打开上述网站下载并安装</li><li>Linux: 使用包管理工具安装</li><li>macOS: 使用 Homebrew 安装<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install sdcc</span></span></code></pre></div></li></ul><p>安装完成后, 查看<code>SDCC</code>版本, 如果有输出说明安装成功.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sdcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><h3 id="编写源码" tabindex="-1">编写源码 <a class="header-anchor" href="#编写源码" aria-label="Permalink to &quot;编写源码&quot;">​</a></h3><p>示例代码 codes/demo200-51-led</p><ol><li>打开<code>STC89C52RC数据手册</code>, 找到<code>P2</code>寄存器的地址为<code>0xA0</code>(3.3特殊功能寄存器), 寄存器默认值为<code>0b11111111</code>. 如果需要将<code>P2.1</code>引脚设置为低电平, 则需要将改寄存器的值修改为<code>0b10111111</code></li><li>打开<a href="https://sdcc.sourceforge.net/doc/sdccman.pdf" target="_blank" rel="noreferrer">SDCC 用户手册</a>. 发现存在两个关键字<code>__sfr</code>和<code>__sbit</code>. 它们的作用分别为: <ul><li>__sfr(Special Function Register)关键字用于声明 8051 微控制器中的特殊功能寄存器, 这些寄存器与微控制器的特定硬件功能（如端口、定时器、串口等）直接相关. __sfr 允许程序员通过变量名直接访问这些寄存器.</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">__sfr </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) P0;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // P0 被声明为一个特殊功能寄存器, 地址为 0x80</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 0b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00001111</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // 将 P0 寄存器的值设置为 0b00001111</span></span></code></pre></div><ul><li>__sbit(Special Bit)关键字用于声明和访问特殊功能寄存器中的单个位, 通常用于直接控制或读取某个位的状态, 比如控制引脚的高低电平</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">__sbit </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) P0_0;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // P0_0 被声明为一个特殊位, 对应 P0 端口的第 0 位</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> P1_0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 将 P1.0 设为低电平</span></span></code></pre></div></li><li>创建文件夹<code>demo200-51-led</code></li><li>创建文件<code>demo200-51-led/src/main.c</code><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __sbit </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">A1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) P2_1 ;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   P2_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 将 P2.1 设为低电平</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div></li></ol><h3 id="编译" tabindex="-1">编译 <a class="header-anchor" href="#编译" aria-label="Permalink to &quot;编译&quot;">​</a></h3><ol><li>使用编译器将<code>main.c</code>文件转换为一个机器码文件<code>firmware.hex</code><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build # 如需</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sdcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/firmware.hex src/main.c</span></span></code></pre></div></li><li>打开<code>firmware.hex</code>文件, 发现内容物是一堆机器码.<div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span> :03000000020006F5</span></span>
<span class="line"><span> ...</span></span>
<span class="line"><span> :00000001FF</span></span></code></pre></div></li></ol><h3 id="烧录" tabindex="-1">烧录 <a class="header-anchor" href="#烧录" aria-label="Permalink to &quot;烧录&quot;">​</a></h3><p>我们打开<code>STC89C52RC数据手册</code>, 10.1.1 在系统可编程（ISP）原理使用说明. 了解到给<code>STC89C52RC微控制器</code>烧录程序有 5 个步骤, 其中前两个步骤需要程序员来进行操作. <img src="/learn-embedded-system/assets/e23edca33a1dc7cd2a7069f82af5dd983f26bd3a3af50e15d48c7df8c0903647.C7LfcjyU.png" alt="picture 1"></p><ol><li>程序员使用PC端烧录软件向单片机传输命令流</li><li>程序员手动给单片机上电复位</li><li>单片机复位后检测RxD是否有合法下载命令流</li><li>单片机下载用户程序</li><li>单片机进入用户程序区</li></ol><p>了解了基本流程后, 我们开始实现这个流程.</p><ol><li>查看<code>开发板原理图</code>得知该开发板使用<code>CH340</code>芯片, 通过该芯片USB信号转换为TTL（Transistor-Transistor Logic）电平信号, 进而将程序从PC下载到单片机. 为此我们将需要安装<code>CH340</code>芯片的驱动, 使得PC能够将开发板识别为一个普普通通的USB设备.</li><li>在 Linux, macOS上你可以通过查看<code>/dev/</code>文件夹的文件列表来查看操作系统设备到的设备.<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/cu</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> # 使用CH340芯片的USB设备一般是cu开头</span></span></code></pre></div></li><li>(如需)根据你的PC的操作系统安装对于的驱动 <a href="https://www.wch.cn/downloads/CH341SER_ZIP.html" target="_blank" rel="noreferrer">wch CH341 驱动下载</a>. 安装完成后再次列出设备, 看看PC是否已经设备到开发板. 我的设备路径是<code>/dev/cu.usbserial-140</code></li><li>(如需)本次我们将使用<a href="https://github.com/grigorig/stcgal" target="_blank" rel="noreferrer">stcgal 烧录器</a>进行烧录. 请根据文档要求进行安装<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install stcgal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stcgal</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -V</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 验证安装, 成功会返回版本号</span></span></code></pre></div></li><li>将开发板连接到PC, 按下开发板电源开关, 使得开发板通上电.</li><li>运行烧录指令, 获得提示 &quot;Waiting for MCU, please cycle power&quot;.<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sdcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/firmware.hex src/main.c</span></span></code></pre></div></li><li>根据提醒, 按下开发板电源开关, 开发板断电. 再次按下开发板电源开关, 开发板通电. 如果一切运行良好, 终端中会打印出一些文字, 类似&quot;Writing flash: 640 Bytes [00:00, 7483.63 Bytes/s]&quot;. 显示出PC正在向单片机传输程序.</li><li>传输完成后, 单片机会自动开始运行收到的用户程序. 也就是我此时我们应该能看到<code>D2</code>LED灯被点亮.</li></ol><p>额外练习:</p><ul><li>通过修改<code>P2</code>寄存器的值来控制LED灯的亮灭.</li></ul><h3 id="可选-安装-platformio" tabindex="-1">(可选)安装 PlatformIO <a class="header-anchor" href="#可选-安装-platformio" aria-label="Permalink to &quot;(可选)安装 PlatformIO&quot;">​</a></h3><p>尽管我们在命令行中手动完成整个流程, 但是使用安装<code>PlatformIO</code>可以一些额外的好处. 比如说, 自动找到开发板的设备名称.</p><p>示例代码 codes/demo201-51-platformio-led</p><ol><li>下载<code>VS Code</code></li><li>在<code>VS Code</code>中安装<code>PlatformIO</code>插件</li><li>创建<code>PlatformIO</code>工程, 开发板型号选择<code>STC89C52RC</code></li><li>编写<code>main.c</code></li><li>编译工程以生成机器码文件 <code>.pio/build/STC89C52RC/firmware.hex</code><ul><li>选项1: 使用<code>PlatformIO</code>插件的<code>Build</code>按钮</li><li>选择2: PlatformIO CLI(需要手动安装, 然后把路径添加到环境变量中)<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre></div></li></ul></li><li>将机器码文件烧录进<code>MCU</code>中. <code>Platform IO</code>自带烧录器, 但是我实际操作没有成功过, 所以我采用的都是手动模式<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 pio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run --target upload</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 stcgal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stcgal</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stc89 -p /dev/cu.usbserial-140 ./.pio/build/STC89C52RC/firmware.hex</span></span></code></pre></div></li></ol></div></div></main><footer class="VPDocFooter" data-v-7208151a data-v-8724bd9e><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"D4MgU5AU\",\"zh_51-mcu-timer.md\":\"CrX3H5t4\",\"zh_setup-development-environment-for-51-mcu.md\":\"khDq-pYu\",\"zh_51-mcu.md\":\"C3dbgH1o\",\"zh_51-mcu-i2c.md\":\"ufO0zpB7\",\"zh_index.md\":\"Cnz73vMZ\",\"zh_51-mcu-uart.md\":\"CPqN-rdF\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"VitePress\",\"description\":\"A VitePress site\",\"base\":\"/learn-embedded-system/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"About\",\"link\":\"https://arnosolo.github.io/blog/\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/arnosolo\"}],\"logo\":\"/big-yellow.svg\"},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"title\":\"Learn embedded system\",\"description\":\"Here are some articles about embedded system.\"},\"zh\":{\"label\":\"简体中文\",\"lang\":\"zh-CN\",\"link\":\"/zh/\",\"title\":\"学习嵌入式系统\",\"description\":\"这里有一些关于嵌入式系统的文章.\"}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>